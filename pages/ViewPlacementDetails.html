<!DOCTYPE html>
<html>

<head>
    <title>ViewPlacementDetails</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body onload="receiveWorkplace()">

    <div class="sidenav">
        <a href="workplacelist.html">Back</a>

    </div>

    <div class="main">
        <h2>Placement Details</h2>

        <meta name="viewport" content="width=device-width, initial-scale=1">
        <style>
            table {
                border-collapse: collapse;
                border-spacing: 0;
                width: 100%;
                border: 1px solid #ddd;
            }

            th,
            td {
                text-align: left;
                padding: 16px;
            }

            tr:nth-child(even) {
                background-color: #f2f2f2
            }
        </style>

        <a href="EditPlacementDetails.html">
            <button class="editBtn" type="button" id="editPlacement" onclick=sendDetails()>
                <i class="fa fa-edit"></i> Edit</button>
        </a>
        <!--
<button class="btn" id="">
    <i class="fa fa-edit" ></i> Edit
</button>
-->

        <!--<textarea id = "sample"></textarea>-->
        <table>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Places Available</th>
                <th>Location</th>
                <th>County</th>


            </tr>
            <tr>
                <td id="id"></td>
                <td id="name"></td>
                <td id="place"></td>
                <td id="loc"></td>
                <td id="county"></td>



            </tr>
        </table>

        <div id="mapCanvas" style="width:100%;height:400px;"></div>
        <!-- <script>
    function initialize() {
    var map;
    var bounds = new google.maps.LatLngBounds();
    var mapOptions = {
        mapTypeId: 'roadmap'
    };
    var geocoder = new google.maps.Geocoder();
    // Display a map on the page
    map = new google.maps.Map(document.getElementById("mapCanvas"), mapOptions);

    // Multiple Markers
    var markers = [
        ['London Eye, London', 51.503454,-0.119562],
        ['Palace of Westminster, London', 51.499633,-0.124755]
    ];


    // Loop through our array of markers & place each one on the map
    for( i = 0; i < markers.length; i++ ) {
        var position = new google.maps.LatLng(markers[i][1], markers[i][2]);
        bounds.extend(position);
        marker = new google.maps.Marker({
            position: position,
            map: map,
            title: markers[i][0]
        });
        map.fitBounds(bounds);
    }

    // Override our map zoom level once our fitBounds function runs (Make sure it only runs once)
    var boundsListener = google.maps.event.addListener((map), 'bounds_changed', function(event) {
        this.setZoom(14);
        google.maps.event.removeListener(boundsListener);
    });

}
  </script> -->
        <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBGrIpLfAxR0NDgSODLhzH5f7I2bJgXdMs&callback=initMap">
        </script>
        <!-- <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBGrIpLfAxR0NDgSODLhzH5f7I2bJgXdMs&callback=initialize"></script> -->


        <script>
            var data;
            function receiveWorkplace() {
                var place = decodeURIComponent(window.location.search);
                data = place;
                place = place.substring(1);
                console.log(place);

                var newString = place.replace("place=<td>", "");


                const splitString = newString.split("</td><td>");

                var whole = splitString;

                var placeId = splitString[0];
                var name = splitString[4]
                var county = splitString[3];
                var location = splitString[2];
                var places = splitString[1];
			




                //    document.getElementById("sample").innerHTML = whole;

                document.getElementById("id").innerHTML = placeId;

                document.getElementById("county").innerHTML = county;

                document.getElementById("loc").innerHTML = location;

                document.getElementById("place").innerHTML = places;

                document.getElementById("name").innerHTML = name;
				

            }

            function sendDetails() {
                console.log(data);
                var qs = "?place=" + data;
                window.location.href = "EditPlacementDetails.html" + qs;

            }


            //------- Google maps stuff
            function initMap() {

                var geocoder = new google.maps.Geocoder();
                var latlng = new google.maps.LatLng(53.3498, -6.2603);
                var mapOptions = {
                    zoom: 8,
                    center: latlng,
                    componentRestrictions: {
                        country: "ire"
                    }
                }
                var map = new google.maps.Map(document.getElementById('mapCanvas'), mapOptions);
                codeAddress(geocoder, map);
            }

            function codeAddress(geocoder, resultsMap) {
                // var address = "Maynooth";
                var place = decodeURIComponent(window.location.search);
                place = place.substring(1);
                var newString = place.replace("place=<td>", "");
                const splitString = newString.split("</td><td>");
                var address = splitString[5];
                console.log(address+"MAPS ADDRESS");
                geocoder.geocode({
                    'address': address
                }, function (results, status) {
                    if (status === 'OK') {
                        resultsMap.setCenter(results[0].geometry.location);
                        var marker = new google.maps.Marker({
                            map: resultsMap,
                            position: results[0].geometry.location,
							title: address
                        });
                    } else {
                        alert('Geocode was not successful for the following reason: ' + status);
                    }
                });
            }
        </script>
    </div>
</body>

</html>
